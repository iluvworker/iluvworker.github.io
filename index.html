document.getElementById("loginForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();
  const error = document.getElementById("error-message");

  // users.jsonからデータ読み込み
  fetch("users.json?v=" + new Date().getTime())
    .then((response) => response.json())
    .then((accounts) => {
      let loginSuccess = false;

      // 各ユーザーをループして照合
      for (let role in accounts) {
        const user = accounts[role];
        if (username === user.username && password === user.password) {
          loginSuccess = true;
          if (role === "admin") {
            window.location.href = "admin.html";
          } else {
            window.location.href = "worker.html";
          }
          break;
        }
      }

      if (!loginSuccess) {
        error.textContent = "ユーザー名またはパスワードが正しくありません。";
        error.style.color = "red";
      }
    })
    .catch((err) => {
      console.error("Error loading users.json:", err);
      error.textContent = "ログイン情報の読み込みに失敗しました。";
      error.style.color = "red";
    });
});
