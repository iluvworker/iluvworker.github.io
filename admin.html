<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>母音＋「…」テキスト崩し</title>
<meta name="robots" content="noindex,nofollow" />
<style>
  body{
    font-family:-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN",sans-serif;
    background:#0f172a;
    color:#e6eef8;
    margin:0;
    padding:20px;
  }
  h1{font-size:18px;margin-bottom:8px;}
  h2{font-size:14px;margin:14px 0 4px;}
  label{font-size:12px;color:#9fb7f8;display:block;margin-top:6px;}
  textarea,input{
    font-family:inherit;
    font-size:13px;
  }
  textarea{
    width:100%;
    box-sizing:border-box;
    min-height:48px;
    border-radius:8px;
    border:none;
    padding:6px 8px;
    background:#101c3b;
    color:#fff;
    margin-top:3px;
  }
  input[type="number"]{
    box-sizing:border-box;
    width:100%;
    max-width:120px;
    border-radius:6px;
    border:none;
    padding:4px 6px;
    background:#101c3b;
    color:#fff;
    margin-top:3px;
  }
  button{
    margin-top:10px;
    margin-right:6px;
    padding:6px 12px;
    border-radius:6px;
    border:none;
    background:#2563eb;
    color:#fff;
    cursor:pointer;
    font-size:13px;
  }
  button:hover{opacity:.9;}
  .counter{
    font-size:12px;
    color:#9fb7f8;
    text-align:right;
    margin-top:4px;
  }
  .row{
    display:flex;
    flex-wrap:wrap;
    gap:12px 20px;
    margin-top:6px;
  }
</style>
</head>
<body>
<h1>母音＋「…」テキスト崩し</h1>

<section>
  <h2>① ベース文字列</h2>
  <label for="baseText">適当にベースを書いてね（母音と「…」だけ拾われます）</label>
  <textarea id="baseText" placeholder="例：あ♡あんっ♡…"></textarea>
</section>

<section>
  <h2>② パラメータ</h2>
  <div class="row">
    <div>
      <label for="targetLen">目標文字数（だいたい）</label>
      <input id="targetLen" type="number" value="10" min="4" />
    </div>
    <div>
      <label for="repeatMax">同じ文字の最大連続回数</label>
      <input id="repeatMax" type="number" value="3" min="1" />
    </div>
  </div>
</section>

<section>
  <h2>③ 生成結果</h2>
  <button onclick="generateOnce()">1回生成</button>
  <button onclick="generateOnce();copyResult()">生成してコピー</button>
  <textarea id="resultText" placeholder="ここに生成結果が出ます"></textarea>
  <div class="counter">文字数：<span id="resultLen">0</span></div>
</section>

<script>
function randomInt(min, max){
  min = Math.floor(min);
  max = Math.floor(max);
  if(max < min){ [min, max] = [max, min]; }
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function randomPick(arr){
  return arr[Math.floor(Math.random() * arr.length)];
}

function generateOnce(){
  const raw = document.getElementById("baseText").value || "";
  const targetLen = Number(document.getElementById("targetLen").value || 10);
  const repeatMax = Number(document.getElementById("repeatMax").value || 3);

  // 使っていい文字：あいうえお・ぁぃぅぇぉ・… だけ
  const allowed = /[あいうえおぁぃぅぇぉ…]/u;

  // ベースから「使っていい文字」だけを抽出
  let baseChars = [];
  for(const ch of raw){
    if(allowed.test(ch)){
      baseChars.push(ch);
    }
  }

  // もしベースに何もなければデフォルトセット
  if(baseChars.length === 0){
    baseChars = ["あ","い","う","え","お","…"];
  }

  let out = "";

  while(out.length < targetLen){
    const ch = randomPick(baseChars);
    const repeat = randomInt(1, repeatMax);
    out += ch.repeat(repeat);
  }

  // 少しオーバーしたら微調整（±2文字くらいの誤差は許容）
  if(out.length > targetLen + 2){
    out = out.slice(0, targetLen + 2);
  }

  const res = document.getElementById("resultText");
  res.value = out;
  document.getElementById("resultLen").innerText = out.length;
}

function copyResult(){
  const res = document.getElementById("resultText");
  res.select();
  document.execCommand("copy");
}

document.getElementById("resultText").addEventListener("input", () => {
  document.getElementById("resultLen").innerText =
    document.getElementById("resultText").value.length;
});
</script>
</body>
</html>
