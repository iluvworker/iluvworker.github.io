<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>母音＋「…」びよーんジェネレータ</title>
<meta name="robots" content="noindex,nofollow" />
<style>
  body{
    font-family:-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN",sans-serif;
    background:#0f172a;
    color:#e6eef8;
    margin:0;
    padding:20px;
  }
  h1{font-size:18px;margin-bottom:8px;}
  h2{font-size:14px;margin:14px 0 4px;}
  label{font-size:12px;color:#9fb7f8;display:block;margin-top:6px;}
  textarea,input{
    font-family:inherit;
    font-size:13px;
  }
  textarea{
    width:100%;
    box-sizing:border-box;
    min-height:48px;
    border-radius:8px;
    border:none;
    padding:6px 8px;
    background:#101c3b;
    color:#fff;
    margin-top:3px;
  }
  input[type="number"]{
    box-sizing:border-box;
    width:100%;
    max-width:120px;
    border-radius:6px;
    border:none;
    padding:4px 6px;
    background:#101c3b;
    color:#fff;
    margin-top:3px;
  }
  button{
    margin-top:10px;
    margin-right:6px;
    padding:6px 12px;
    border-radius:6px;
    border:none;
    background:#2563eb;
    color:#fff;
    cursor:pointer;
    font-size:13px;
  }
  button:hover{opacity:.9;}
  .counter{
    font-size:12px;
    color:#9fb7f8;
    text-align:right;
    margin-top:4px;
  }
  .row{
    display:flex;
    flex-wrap:wrap;
    gap:12px 20px;
    margin-top:6px;
  }
</style>
</head>
<body>
<h1>母音＋「…」びよーんジェネレータ</h1>

<section>
  <h2>① ベース文字列</h2>
  <label for="baseText">記号や「っ」「ん」はそのまま／母音だけ伸ばします</label>
  <textarea id="baseText">あっ♡あんっ♡</textarea>
</section>

<section>
  <h2>② パラメータ</h2>
  <div class="row">
    <div>
      <label for="targetLen">目標文字数（だいたい）</label>
      <input id="targetLen" type="number" value="20" min="10" />
    </div>
    <div>
      <label for="repeatMax">同じ母音の最大連続回数</label>
      <input id="repeatMax" type="number" value="5" min="1" />
    </div>
    <div>
      <label for="dotsMax">母音の後に付ける「…」最大個数</label>
      <input id="dotsMax" type="number" value="4" min="0" />
    </div>
  </div>
</section>

<section>
  <h2>③ 生成結果</h2>
  <button onclick="generateWithMark();copyResult()">生成+⌘C</button>
  <button onclick="generateWithMark()">生成</button>
  <button onclick="generateOnce()">声だけ</button>
  <button onclick="generateOnce();copyResult()">声だけ+⌘C</button>

  <textarea id="resultText" placeholder="ここに生成結果が出ます"></textarea>
  <div class="counter">文字数：<span id="resultLen">0</span></div>
</section>

<script>
// ランダム系ユーティリティ
function randomInt(min, max){
  min = Math.floor(min);
  max = Math.floor(max);
  if(max < min){ [min, max] = [max, min]; }
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function randomPick(arr){
  return arr[Math.floor(Math.random() * arr.length)];
}

// ★ 母音＋「…」びよーん本体（文字列を返す）
function makeMoanText(){
  const base      = document.getElementById("baseText").value || "";
  const targetLen = Number(document.getElementById("targetLen").value || 16);
  const repeatMax = Number(document.getElementById("repeatMax").value || 3);
  const dotsMax   = Number(document.getElementById("dotsMax").value || 0);

  // 伸ばす対象：ひらがな母音＋小書き
  const vowelRegex = /[あいうえおぁぃぅぇぉ]/u;
  const vowelMap = {
    "あ": ["あ", "ぁ"],
    "い": ["い", "ぃ"],
    "う": ["う", "ぅ"],
    "え": ["え", "ぇ"],
    "お": ["お", "ぉ"],
    "ぁ": ["ぁ"],
    "ぃ": ["ぃ"],
    "ぅ": ["ぅ"],
    "ぇ": ["ぇ"],
    "ぉ": ["ぉ"]
  };

  let out = "";

  for(const ch of base){
    if(vowelRegex.test(ch)){
      const candidates = vowelMap[ch] || [ch];
      const r = randomInt(1, repeatMax); // 何文字分伸ばすか

      // 大文字／小文字をランダム混在で伸ばす
      for(let i = 0; i < r; i++){
        out += randomPick(candidates);
      }

      // ランダムで「…」を挟む
      if(dotsMax > 0){
        const dotCount = randomInt(0, dotsMax);
        if(dotCount > 0){
          out += "…".repeat(dotCount);
        }
      }
    }else{
      // っ・ん・♡ などはそのまま
      out += ch;
    }

    // 目標よりだいぶ超えたら軽く打ち切り
    if(out.length > targetLen + 4){
      break;
    }
  }

  return out;
}

// ★ 声だけ生成（今までのボタン用）
function generateOnce(){
  const text = makeMoanText();
  const res = document.getElementById("resultText");
  res.value = text;
  document.getElementById("resultLen").innerText = text.length;
}

// 《×》ガチャ用：括弧ペア
const bracketPairs = [
  { open: "〈", close: "〉" },
  { open: "《", close: "》" },
  { open: "【", close: "】" },
  { open: "〚", close: "〛" },
  { open: "〖", close: "〗" }
];

// 《×》ガチャ用：中身の記号
const markSymbols = ["|", "×", "★"];

// ★ 《×》ガチャ付き生成
function generateWithMark(){
  const moan = makeMoanText();              // 中身をまず生成
  const pair = randomPick(bracketPairs);    // 括弧ペアガチャ
  const mark = randomPick(markSymbols);     // | / × / ★ ガチャ

  const finalText = `${pair.open}${mark}${pair.close}『${moan}』`;

  const res = document.getElementById("resultText");
  res.value = finalText;
  document.getElementById("resultLen").innerText = finalText.length;
}

// コピー
function copyResult(){
  const res = document.getElementById("resultText");
  res.select();
  document.execCommand("copy");
}

// 手動編集時も文字数を更新
document.getElementById("resultText").addEventListener("input", () => {
  document.getElementById("resultLen").innerText =
    document.getElementById("resultText").value.length;
});
</script>
</body>
</html>
